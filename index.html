<!DOCTYPE html>
<html lang="ja" data-bs-theme="light">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ã€ãƒ¢ãƒƒã‚¯ã€‘GROWI ãƒ•ãƒ­ãƒ³ãƒˆãƒã‚¿ãƒ¼ãƒ“ãƒ¥ãƒ¼ãƒ¯ãƒ¼é–‹ç™ºç’°å¢ƒ</title>

  <!-- Bootstrap 5 (GROWIãŒä½¿ç”¨ã—ã¦ã„ã‚‹ã‚‚ã®ã¨åŒãƒãƒ¼ã‚¸ãƒ§ãƒ³ç³») -->
  <link
    rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap/5.3.3/css/bootstrap.min.css"
  />

  <style>
    /* ============================================================
       GROWI ãƒšãƒ¼ã‚¸ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆã®å†ç¾
       å®Ÿéš›ã®GROWIã®CSSã‚¯ãƒ©ã‚¹åã‚’ä½¿ã£ã¦æœ¬ç•ªã¨åŒã˜æ§‹é€ ã‚’ä½œã‚‹
       ============================================================ */

    :root {
      --grw-sidebar-width: 250px;
      --grw-toc-width: 220px;
      --grw-header-height: 56px;
    }

    body {
      font-family: 'Helvetica Neue', Arial, 'Hiragino Kaku Gothic ProN', sans-serif;
      background: #f8f9fa;
    }

    /* ---- ãƒ˜ãƒƒãƒ€ãƒ¼ ---- */
    .grw-header-mock {
      position: fixed;
      top: 0; left: 0; right: 0;
      height: var(--grw-header-height);
      background: #1a1a2e;
      color: #fff;
      display: flex;
      align-items: center;
      padding: 0 1.5rem;
      z-index: 1050;
      gap: 1rem;
    }

    .grw-header-mock .logo {
      font-weight: 800;
      font-size: 1.2rem;
      letter-spacing: -0.03em;
      color: #4fc3f7;
    }

    .grw-header-mock .path {
      font-size: 0.82rem;
      color: #aaa;
      font-family: 'Consolas', monospace;
    }

    .grw-header-mock .dev-badge {
      margin-left: auto;
      font-size: 0.68rem;
      padding: 0.2rem 0.6rem;
      border-radius: 20px;
      background: #ff6b35;
      color: #fff;
      font-weight: 700;
      letter-spacing: 0.05em;
      animation: blink 2s infinite;
    }

    @keyframes blink {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.6; }
    }

    /* ---- ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ ---- */
    .grw-layout {
      display: grid;
      grid-template-columns: var(--grw-sidebar-width) 1fr var(--grw-toc-width);
      grid-template-rows: var(--grw-header-height) 1fr;
      min-height: 100vh;
      gap: 0;
    }

    /* ---- å·¦ã‚µã‚¤ãƒ‰ãƒãƒ¼ï¼ˆãƒŠãƒ“ï¼‰ ---- */
    .grw-left-sidebar {
      grid-column: 1;
      grid-row: 1 / 3;
      background: #fff;
      border-right: 1px solid #dee2e6;
      padding-top: calc(var(--grw-header-height) + 1rem);
      position: fixed;
      top: 0; left: 0;
      width: var(--grw-sidebar-width);
      height: 100vh;
      overflow-y: auto;
    }

    .grw-sidebar-nav {
      list-style: none;
      padding: 0 0.5rem;
      margin: 0;
    }

    .grw-sidebar-nav li a {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      padding: 0.45rem 0.75rem;
      color: #495057;
      text-decoration: none;
      border-radius: 6px;
      font-size: 0.85rem;
      transition: background 0.12s;
    }

    .grw-sidebar-nav li a:hover,
    .grw-sidebar-nav li a.active {
      background: #e9ecef;
      color: #212529;
    }

    .grw-sidebar-nav .nav-icon { font-size: 1rem; }

    /* ---- ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ ---- */
    .grw-main {
      grid-column: 2;
      grid-row: 2;
      margin-left: var(--grw-sidebar-width);
      margin-right: var(--grw-toc-width);
      padding: calc(var(--grw-header-height) + 2rem) 2rem 3rem;
      min-width: 0;
    }

    /* ---- å³ã‚µã‚¤ãƒ‰ãƒãƒ¼ï¼ˆTOC + ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ãƒ‘ãƒãƒ«ãŒå…¥ã‚‹ã‚¨ãƒªã‚¢ï¼‰ ---- */
    .revision-toc-container {
      position: fixed;
      top: calc(var(--grw-header-height) + 1rem);
      right: 0;
      width: var(--grw-toc-width);
      height: calc(100vh - var(--grw-header-height) - 1rem);
      overflow-y: auto;
      padding: 0.5rem 0.75rem;
      background: #fff;
      border-left: 1px solid #dee2e6;
    }

    .toc-label {
      font-size: 0.72rem;
      font-weight: 600;
      color: #6c757d;
      text-transform: uppercase;
      letter-spacing: 0.06em;
      margin-bottom: 0.5rem;
      padding-bottom: 0.4rem;
      border-bottom: 1px solid #dee2e6;
    }

    .toc-list {
      list-style: none;
      padding: 0;
      margin: 0 0 1rem;
    }

    .toc-list li a {
      display: block;
      font-size: 0.78rem;
      color: #6c757d;
      text-decoration: none;
      padding: 0.18rem 0;
      padding-left: calc(var(--indent, 0) * 0.8rem);
      transition: color 0.1s;
    }

    .toc-list li a:hover { color: #0d6efd; }

    /* ---- Markdown ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ ---- */
    .wiki-content h1 { font-size: 1.8rem; font-weight: 700; padding-bottom: 0.5rem; border-bottom: 2px solid #dee2e6; margin-bottom: 1.5rem; }
    .wiki-content h2 { font-size: 1.35rem; font-weight: 600; margin-top: 2rem; padding-bottom: 0.3rem; border-bottom: 1px solid #dee2e6; }
    .wiki-content h3 { font-size: 1.1rem; font-weight: 600; margin-top: 1.5rem; }
    .wiki-content p  { line-height: 1.8; margin-bottom: 1rem; }
    .wiki-content code { background: #f1f3f5; padding: 0.15rem 0.35rem; border-radius: 4px; font-size: 0.85em; }
    .wiki-content pre { background: #1e1e2e; color: #cdd6f4; padding: 1rem 1.2rem; border-radius: 8px; overflow-x: auto; }
    .wiki-content pre code { background: none; color: inherit; padding: 0; }

    /* ---- ãƒšãƒ¼ã‚¸ãƒ¡ã‚¿æƒ…å ± ---- */
    .page-meta {
      display: flex;
      gap: 1rem;
      font-size: 0.78rem;
      color: #6c757d;
      margin-bottom: 2rem;
      padding-bottom: 1rem;
      border-bottom: 1px solid #f0f0f0;
    }

    .page-meta span { display: flex; align-items: center; gap: 0.3rem; }

    /* ---- ãƒ‡ãƒãƒƒã‚°ãƒ‘ãƒãƒ« ---- */
    .debug-panel {
      margin-top: 2rem;
      padding: 1rem;
      background: #1e1e2e;
      color: #cdd6f4;
      border-radius: 8px;
      font-family: 'Consolas', 'JetBrains Mono', monospace;
      font-size: 0.78rem;
    }

    .debug-panel h6 {
      color: #89dceb;
      margin-bottom: 0.75rem;
      font-size: 0.78rem;
      text-transform: uppercase;
      letter-spacing: 0.06em;
    }

    .debug-control {
      display: flex;
      flex-wrap: wrap;
      gap: 0.5rem;
      margin-bottom: 1rem;
    }

    .debug-control button {
      padding: 0.3rem 0.75rem;
      font-size: 0.75rem;
      border-radius: 6px;
      border: 1px solid #45475a;
      background: #313244;
      color: #cdd6f4;
      cursor: pointer;
      transition: all 0.15s;
    }

    .debug-control button:hover {
      background: #585b70;
      border-color: #cba6f7;
    }

    .debug-control button.active {
      background: #cba6f7;
      color: #1e1e2e;
      border-color: #cba6f7;
      font-weight: 600;
    }
  </style>
</head>
<body>

<!-- ============================================================
     ãƒ˜ãƒƒãƒ€ãƒ¼
     ============================================================ -->
<header class="grw-header-mock">
  <span class="logo">ğŸ”— GROWI</span>
  <span class="path" id="header-path">/è£½å“ãƒãƒ‹ãƒ¥ã‚¢ãƒ«/æ¢±åŒ…æ©Ÿ/PackMaster-3000</span>
  <span class="dev-badge">ğŸ”§ PLUGIN DEV MODE</span>
</header>

<!-- ============================================================
     å·¦ã‚µã‚¤ãƒ‰ãƒãƒ¼
     ============================================================ -->
<nav class="grw-left-sidebar">
  <ul class="grw-sidebar-nav">
    <li><a href="#" class="active"><span class="nav-icon">ğŸ </span> ãƒ›ãƒ¼ãƒ </a></li>
    <li><a href="#"><span class="nav-icon">ğŸ“</span> è£½å“ãƒãƒ‹ãƒ¥ã‚¢ãƒ«</a></li>
    <li><a href="#"><span class="nav-icon">ğŸ”</span> æ¤œç´¢</a></li>
    <li><a href="#"><span class="nav-icon">â­</span> ãƒ–ãƒƒã‚¯ãƒãƒ¼ã‚¯</a></li>
    <li><a href="#"><span class="nav-icon">ğŸ•</span> æœ€è¿‘ã®æ›´æ–°</a></li>
    <hr style="margin: 0.5rem 0.75rem; border-color: #dee2e6" />
    <li><a href="#"><span class="nav-icon">âš™ï¸</span> ç®¡ç†ç”»é¢</a></li>
  </ul>
</nav>

<!-- ============================================================
     å³ã‚µã‚¤ãƒ‰ãƒãƒ¼ï¼ˆTOC + â† ã“ã“ã«ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ãƒ‘ãƒãƒ«ãŒå…¥ã‚‹ï¼‰
     ============================================================ -->
<aside class="revision-toc-container" id="revision-toc-container">
  <!-- â†“ ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ãƒ‘ãƒãƒ«ã¯ã“ã®ã‚³ãƒ³ãƒ†ãƒŠã®å…ˆé ­ã« prepend ã•ã‚Œã‚‹ -->

  <div class="toc-label">ç›®æ¬¡</div>
  <ul class="toc-list">
    <li style="--indent:0"><a href="#">æ¦‚è¦</a></li>
    <li style="--indent:0"><a href="#">ä»•æ§˜</a></li>
    <li style="--indent:1"><a href="#">å‡¦ç†èƒ½åŠ›</a></li>
    <li style="--indent:1"><a href="#">å¯¸æ³•ãƒ»é‡é‡</a></li>
    <li style="--indent:0"><a href="#">æ“ä½œæ‰‹é †</a></li>
    <li style="--indent:1"><a href="#">èµ·å‹•</a></li>
    <li style="--indent:1"><a href="#">åœæ­¢</a></li>
    <li style="--indent:0"><a href="#">ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹</a></li>
  </ul>
</aside>

<!-- ============================================================
     ãƒ¡ã‚¤ãƒ³ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ï¼ˆGROWIã®é–²è¦§ãƒšãƒ¼ã‚¸æœ¬æ–‡ï¼‰
     ============================================================ -->
<main class="grw-main">

  <!-- ãƒšãƒ¼ã‚¸ãƒ¡ã‚¿æƒ…å ± -->
  <div class="page-meta">
    <span>ğŸ“… æ›´æ–°: 2025-11-15</span>
    <span>ğŸ‘¤ ç”°ä¸­ å¤ªéƒ</span>
    <span>ğŸ“‚ /è£½å“ãƒãƒ‹ãƒ¥ã‚¢ãƒ«/æ¢±åŒ…æ©Ÿ</span>
  </div>

  <!-- Markdownãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°çµæœï¼ˆãƒ•ãƒ­ãƒ³ãƒˆãƒã‚¿ãƒ¼ã¯é™¤å»ã•ã‚Œã¦ã„ã‚‹ï¼‰ -->
  <div class="wiki-content" id="wiki-body">
    <h1>PackMaster-3000 æ“ä½œãƒãƒ‹ãƒ¥ã‚¢ãƒ«</h1>

    <h2>æ¦‚è¦</h2>
    <p>PackMaster-3000 ã¯è‡ªå‹•æ¨ªå‹ãƒ”ãƒ­ãƒ¼åŒ…è£…æ©Ÿã§ã™ã€‚é«˜é€Ÿã‹ã¤å®‰å®šã—ãŸåŒ…è£…å‡¦ç†ã‚’å®Ÿç¾ã—ã€
    é£Ÿå“ãƒ»å·¥æ¥­éƒ¨å“ãƒ»åŒ»ç™‚æ©Ÿå™¨ãªã©å¹…åºƒã„è£½å“ã«å¯¾å¿œã—ã¾ã™ã€‚</p>

    <h2>ä»•æ§˜</h2>
    <h3>å‡¦ç†èƒ½åŠ›</h3>
    <p>æœ€å¤§å‡¦ç†é€Ÿåº¦: 120åŒ…/åˆ†ï¼ˆè£½å“å½¢çŠ¶ãƒ»ãƒ•ã‚£ãƒ«ãƒ ã«ã‚ˆã‚Šå¤‰å‹•ï¼‰</p>

    <h3>å¯¸æ³•ãƒ»é‡é‡</h3>
    <p>æœ¬ä½“å¯¸æ³•: W1,200 Ã— D800 Ã— H1,400mm<br>
    é‡é‡: ç´„580kg</p>

    <h2>æ“ä½œæ‰‹é †</h2>
    <h3>èµ·å‹•</h3>
    <p>é›»æºæŠ•å…¥å¾Œã€æ“ä½œãƒ‘ãƒãƒ«ã® <code>POWER</code> ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã€ã‚¦ã‚©ãƒ¼ãƒ ã‚¢ãƒƒãƒ—å®Œäº†ã¾ã§
    ç´„3åˆ†å¾…æ©Ÿã—ã¦ãã ã•ã„ã€‚</p>

    <pre><code>// ç·Šæ€¥åœæ­¢ã‚³ãƒ¼ãƒ‰
ESTOP â†’ èµ¤ãƒœã‚¿ãƒ³é•·æŠ¼ã— 2ç§’
å¾©å¸°  â†’ RESET â†’ START</code></pre>

    <h3>åœæ­¢</h3>
    <p>é€šå¸¸åœæ­¢ã¯ <code>STOP</code> ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¦ãã ã•ã„ã€‚ãƒ•ã‚£ãƒ«ãƒ é€ã‚ŠãŒå®Œäº†ã—ã¦ã‹ã‚‰åœæ­¢ã—ã¾ã™ã€‚</p>

    <h2>ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹</h2>
    <p>æ—¥å¸¸ç‚¹æ¤œã¯ã‚·ãƒ•ãƒˆé–‹å§‹å‰ã«å®Ÿæ–½ã—ã¦ãã ã•ã„ã€‚è©³ç´°ã¯ä¿å®ˆç‚¹æ¤œãƒã‚§ãƒƒã‚¯ã‚·ãƒ¼ãƒˆã‚’å‚ç…§ã€‚</p>
  </div>

  <!-- ============================================================
       ãƒ‡ãƒãƒƒã‚°ãƒ‘ãƒãƒ«ï¼ˆé–‹ç™ºå°‚ç”¨ï¼šãƒ•ãƒ­ãƒ³ãƒˆãƒã‚¿ãƒ¼ã®ãƒ‡ãƒ¼ã‚¿ã‚’åˆ‡ã‚Šæ›¿ãˆï¼‰
       ============================================================ -->
  <div class="debug-panel">
    <h6>ğŸ”§ ãƒ‡ãƒãƒƒã‚°: ãƒ•ãƒ­ãƒ³ãƒˆãƒã‚¿ãƒ¼å†…å®¹ã‚’åˆ‡ã‚Šæ›¿ãˆ</h6>
    <div class="debug-control">
      <button class="active" onclick="setScenario('full')">è£½å“ãƒšãƒ¼ã‚¸ï¼ˆãƒ•ãƒ«ï¼‰</button>
      <button onclick="setScenario('minimal')">æœ€å°é™</button>
      <button onclick="setScenario('array')">é…åˆ—ã‚ã‚Š</button>
      <button onclick="setScenario('empty')">ãƒ•ãƒ­ãƒ³ãƒˆãƒã‚¿ãƒ¼ãªã—</button>
    </div>
    <div id="debug-yaml-preview" style="white-space:pre;color:#a6e3a1;">Loading...</div>
  </div>

</main>

<!-- ============================================================
     GROWI APIãƒ¢ãƒƒã‚¯ + ãƒ—ãƒ©ã‚°ã‚¤ãƒ³èµ·å‹•ã‚¹ã‚¯ãƒªãƒ—ãƒˆ
     ============================================================ -->
<script>
  // ============================================================
  // ã‚·ãƒŠãƒªã‚ªå®šç¾©ï¼šé–‹ç™ºä¸­ã«åˆ‡ã‚Šæ›¿ãˆã¦å‹•ä½œç¢ºèªã™ã‚‹ãƒ¢ãƒƒã‚¯ãƒ‡ãƒ¼ã‚¿
  // ============================================================
  const SCENARIOS = {
    full: `---
title: PackMaster-3000 æ“ä½œãƒãƒ‹ãƒ¥ã‚¢ãƒ«
category: æ¢±åŒ…æ©Ÿ
model: PM-3000
status: å…¬é–‹ä¸­
version: 3.2
author: ç”°ä¸­ å¤ªéƒ
reviewer: å±±ç”° èŠ±å­
published: true
tags:
  - æ¢±åŒ…æ©Ÿ
  - ãƒ”ãƒ­ãƒ¼åŒ…è£…
  - è‡ªå‹•åŒ–
language: ja
last_reviewed: 2025-11-01
---`,

    minimal: `---
title: PackMaster-3000
status: è‰ç¨¿
---`,

    array: `---
tags: [æ¢±åŒ…æ©Ÿ, ãƒ”ãƒ­ãƒ¼åŒ…è£…, é£Ÿå“å¯¾å¿œ, CEèªè¨¼å–å¾—æ¸ˆã¿]
compatible_products:
  - PM-3000-A
  - PM-3000-B
  - PM-3000-C
revisions: 12
is_archived: false
---`,

    empty: '' // ãƒ•ãƒ­ãƒ³ãƒˆãƒã‚¿ãƒ¼ãªã—
  };

  let currentScenario = 'full';

  // ============================================================
  // GROWIã®fetchPageFrontmatter()ãŒå©ã /api/v3/page ã‚’ãƒ¢ãƒƒã‚¯
  // Service Workerã¯é‡ã„ã®ã§ fetch ã®ãƒ¢ãƒ³ã‚­ãƒ¼ãƒ‘ãƒƒãƒã§ä»£æ›¿
  // ============================================================
  const originalFetch = window.fetch;
  window.fetch = function(url, ...args) {
    if (typeof url === 'string' && url.startsWith('/api/v3/page')) {
      // APIãƒ¬ã‚¹ãƒãƒ³ã‚¹ã‚’ãƒ¢ãƒƒã‚¯
      const body = SCENARIOS[currentScenario] || '';
      const mockBody = body
        ? body + '\n\n# PackMaster-3000 æ“ä½œãƒãƒ‹ãƒ¥ã‚¢ãƒ«\n\næœ¬æ–‡...'
        : '# ãƒ•ãƒ­ãƒ³ãƒˆãƒã‚¿ãƒ¼ãªã—\n\næœ¬æ–‡...';

      const mockResponse = {
        ok: true,
        status: 200,
        json: async () => ({
          data: {
            page: {
              revision: { body: mockBody }
            }
          }
        })
      };
      console.log(`[MOCK API] GET ${url} â†’ ã‚·ãƒŠãƒªã‚ª: ${currentScenario}`);
      return Promise.resolve(mockResponse);
    }
    return originalFetch.call(this, url, ...args);
  };

  // ============================================================
  // growiFacade ãƒ¢ãƒƒã‚¯ï¼ˆGROWI ã‚³ã‚¢ã®APIï¼‰
  // ============================================================
  window.growiFacade = {
    version: '7.0.0-mock',
    markdownRenderer: { isReady: true },
  };

  window.pluginActivators = {};

  // ============================================================
  // ã‚·ãƒŠãƒªã‚ªåˆ‡ã‚Šæ›¿ãˆé–¢æ•°
  // ============================================================
  function setScenario(name) {
    currentScenario = name;

    // ãƒœã‚¿ãƒ³çŠ¶æ…‹æ›´æ–°
    document.querySelectorAll('.debug-control button').forEach(btn => {
      btn.classList.toggle('active', btn.textContent.includes(
        { full: 'ãƒ•ãƒ«', minimal: 'æœ€å°é™', array: 'é…åˆ—', empty: 'ãªã—' }[name]
      ));
    });

    // YAMLãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼æ›´æ–°
    const yaml = SCENARIOS[name];
    document.getElementById('debug-yaml-preview').textContent =
      yaml ? yaml : '(ãƒ•ãƒ­ãƒ³ãƒˆãƒã‚¿ãƒ¼ãªã—)';

    // ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚’å†ãƒã‚¦ãƒ³ãƒˆ
    const existing = document.getElementById('grw-frontmatter-panel-root');
    if (existing) existing.remove();

    if (window.pluginActivators['growi-plugin-frontmatter-viewer']) {
      window.pluginActivators['growi-plugin-frontmatter-viewer'].activate();
    }
  }

  // ============================================================
  // åˆæœŸè¡¨ç¤º
  // ============================================================
  document.getElementById('debug-yaml-preview').textContent = SCENARIOS['full'];
</script>

<!-- Vite ã®ã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆï¼ˆHMRå¯¾è±¡ï¼‰ -->
<script type="module" src="/client-entry.tsx"></script>

<script>
  // ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ç™»éŒ²å¾Œã« activate() ã‚’å‘¼ã¶
  // (client-entry.tsx ãŒ window.pluginActivators ã«ç™»éŒ²å®Œäº†ã—ãŸã‚¿ã‚¤ãƒŸãƒ³ã‚°ã§å®Ÿè¡Œ)
  window.addEventListener('load', () => {
    setTimeout(() => {
      const activator = window.pluginActivators?.['growi-plugin-frontmatter-viewer'];
      if (activator) {
        activator.activate();
      } else {
        console.error('ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ãŒç™»éŒ²ã•ã‚Œã¦ã„ã¾ã›ã‚“ã€‚client-entry.tsx ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚');
      }
    }, 100); // Reactã®ãƒã‚¦ãƒ³ãƒˆã‚’å¾…ã¤
  });
</script>

</body>
</html>
